<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roaming Heart Squad - Catch Me!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --bg-color: #0f172a;
            --text-color: #f8fafc;
            --heart-glow: rgba(255, 77, 109, 0.5);
        }

        body.light-mode {
            --bg-color: #f1f5f9;
            --text-color: #1e293b;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.5s ease, color 0.5s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
        }

        /* Lightbulb Toggle and Timer Container */
        .controls-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 100;
        }

        .bulb-container {
            cursor: pointer;
            margin-bottom: 8px;
        }

        .bulb {
            width: 44px;
            height: 44px;
            fill: #475569;
            transition: fill 0.3s ease, filter 0.3s ease;
        }

        .light-mode .bulb {
            fill: #fbbf24;
            filter: drop-shadow(0 0 12px #fbbf24);
        }

        #timerDisplay {
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            font-size: 1.2rem;
            background: rgba(0, 0, 0, 0.2);
            padding: 4px 12px;
            border-radius: 12px;
            backdrop-filter: blur(4px);
        }

        /* Heart Squad Styling */
        .heart-container {
            position: absolute;
            cursor: pointer;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            width: 90px;
            height: 90px;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .heart-container.main-heart {
            width: 150px;
            height: 150px;
            z-index: 60;
        }

        .heart-container:hover {
            transform: scale(1.15);
        }

        .heart {
            position: relative;
            width: 60%;
            height: 60%;
            background-color: var(--heart-color, #ff4d6d);
            transform: rotate(-45deg);
            animation: heartbeat 1.2s infinite;
            box-shadow: 0 0 20px var(--heart-glow);
            transition: background-color 0.5s ease, box-shadow 0.5s ease;
        }

        .heart::before,
        .heart::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: inherit;
            border-radius: 50%;
        }

        .heart::before { top: -50%; left: 0; }
        .heart::after { left: 50%; top: 0; }

        @keyframes heartbeat {
            0% { transform: rotate(-45deg) scale(0.8); }
            15% { transform: rotate(-45deg) scale(1); }
            30% { transform: rotate(-45deg) scale(0.8); }
            45% { transform: rotate(-45deg) scale(0.95); }
            60% { transform: rotate(-45deg) scale(0.8); }
            100% { transform: rotate(-45deg) scale(0.8); }
        }

        .heart.clicked {
            animation: burst 0.6s forwards !important;
            pointer-events: none;
        }

        @keyframes burst {
            0% { transform: rotate(-45deg) scale(1); opacity: 1; }
            50% { transform: rotate(-45deg) scale(2.5); opacity: 0.5; }
            100% { transform: rotate(-45deg) scale(4); opacity: 0; }
        }

        /* Messages */
        #message {
            position: relative;
            z-index: 10;
            font-size: 2.2rem;
            font-weight: bold;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease, transform 0.8s ease;
            pointer-events: none;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        #grandLoveMessage {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            z-index: 200;
            font-size: 6rem;
            font-weight: 900;
            text-align: center;
            color: #ff4d6d;
            opacity: 0;
            pointer-events: none;
            text-shadow: 0 0 30px rgba(255, 77, 109, 0.6);
            transition: all 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            width: 100%;
        }

        .show-grand {
            opacity: 1 !important;
            transform: translate(-50%, -50%) scale(1) !important;
        }

        .show-message {
            opacity: 1 !important;
            transform: translateY(0) !important;
        }

        .instruction {
            position: absolute;
            bottom: 30px;
            font-size: 1.1rem;
            color: #94a3b8;
            font-weight: 500;
            letter-spacing: 0.05em;
            pointer-events: none;
            background: rgba(15, 23, 42, 0.4);
            padding: 8px 20px;
            border-radius: 20px;
            backdrop-filter: blur(4px);
        }

        .sparkle-particle {
            position: absolute;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 40;
        }

        /* Floating Quote Style */
        .floating-quote {
            position: fixed;
            pointer-events: none;
            z-index: 200;
            font-style: italic;
            font-weight: 700;
            text-align: center;
            max-width: 280px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.4); 
            font-size: 1.1rem;
            padding: 10px;
        }
    </style>
</head>
<body id="gameBody">

    <div class="controls-container">
        <div class="bulb-container" id="themeToggle" title="Toggle Light/Dark Mode">
            <svg class="bulb" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1zM9 19h6v1H9v-1zm1 2h4v1h-4v-1z"/>
            </svg>
        </div>
        <div id="timerDisplay">01:00</div>
    </div>

    <div id="message">ðŸ’– Heart Master! ðŸ’–<br><span style="font-size: 1.2rem; font-weight: normal;">You've captured all the love in the world!</span></div>
    
    <div id="grandLoveMessage">I LOVE YOU</div>
    
    <div class="instruction" id="instructionText">Catch all hearts! Don't miss or more will spawn!</div>

    <script>
        const themeToggle = document.getElementById('themeToggle');
        const body = document.getElementById('gameBody');
        const message = document.getElementById('message');
        const instructionText = document.getElementById('instructionText');
        const timerDisplay = document.getElementById('timerDisplay');
        const grandLoveMessage = document.getElementById('grandLoveMessage');

        const loveQuotes = [
            "Love is composed of a single soul inhabiting two bodies.",
            "You are my sun, my moon, and all my stars.",
            "Where there is love there is life.",
            "Love recognizes no barriers.",
            "I have found the one whom my soul loves.",
            "Love is the beauty of the soul.",
            "To love and be loved is to feel the sun from both sides.",
            "All you need is love.",
            "Love is just a word until someone comes along and gives it meaning.",
            "Being deeply loved by someone gives you strength.",
            "Love is like the wind, you can't see it but you can feel it.",
            "Whatever our souls are made of, his and mine are the same."
        ];

        const heartConfigs = [
            { color: '#ff4d6d', emoji: 'â¤ï¸', size: 'main-heart' },
            { color: '#ffffff', emoji: 'ðŸ¤', size: 'small' },
            { color: '#3b82f6', emoji: 'ðŸ’™', size: 'small' },
            { color: '#0ea5e9', emoji: 'ðŸ©µ', size: 'small' },
            { color: '#a855f7', emoji: 'ðŸ’œ', size: 'small' },
            { color: '#ec4899', emoji: 'ðŸ©·', size: 'small' },
            { color: '#eab308', emoji: 'ðŸ’›', size: 'small' },
            { color: '#111827', emoji: 'ðŸ–¤', size: 'small' }
        ];

        const activeHearts = [];
        let heartsBursted = 0;
        let totalHeartsCreated = 0;
        let timeLeft = 60;
        let gameActive = true;

        // Timer Functionality
        const countdown = setInterval(() => {
            if (!gameActive) {
                clearInterval(countdown);
                return;
            }
            timeLeft--;
            const mins = Math.floor(timeLeft / 60);
            const secs = timeLeft % 60;
            timerDisplay.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;

            if (timeLeft <= 0) {
                clearInterval(countdown);
                triggerFinale();
            }
        }, 1000);

        function triggerFinale() {
            gameActive = false;
            activeHearts.forEach(heartObj => {
                if (!heartObj.isBursted) {
                    burstHeart(heartObj);
                }
            });
            
            // Show the grand message
            grandLoveMessage.classList.add('show-grand');
            instructionText.style.opacity = '0';
            timerDisplay.style.opacity = '0';
        }

        // Dark/Light Mode Toggle
        themeToggle.addEventListener('click', (e) => {
            e.stopPropagation(); 
            body.classList.toggle('light-mode');
        });

        // Miss detection
        body.addEventListener('click', (e) => {
            if (!gameActive) return;
            if (!e.target.closest('.heart-container') && !e.target.closest('.controls-container')) {
                spawnRandomHeart();
            }
        });

        function createHeart(config) {
            const container = document.createElement('div');
            container.className = `heart-container ${config.size === 'main-heart' ? 'main-heart' : ''}`;
            
            const heartDiv = document.createElement('div');
            heartDiv.className = 'heart';
            heartDiv.style.setProperty('--heart-color', config.color);
            heartDiv.style.setProperty('--heart-glow', config.color + '80');
            
            container.appendChild(heartDiv);
            document.body.appendChild(container);

            const sizePx = config.size === 'main-heart' ? 150 : 90;
            totalHeartsCreated++;
            
            const heartObj = {
                el: container,
                innerEl: heartDiv,
                config: config,
                x: Math.random() * (window.innerWidth - sizePx),
                y: Math.random() * (window.innerHeight - sizePx),
                vx: (Math.random() - 0.5) * (config.size === 'main-heart' ? 3 : 5),
                vy: (Math.random() - 0.5) * (config.size === 'main-heart' ? 3 : 5),
                size: sizePx,
                isBursted: false
            };

            container.addEventListener('click', (e) => {
                e.stopPropagation(); 
                if (!heartObj.isBursted && gameActive) {
                    burstHeart(heartObj);
                }
            });

            activeHearts.push(heartObj);
            updateProgress();
        }

        function burstHeart(heartObj) {
            heartObj.isBursted = true;
            heartObj.innerEl.classList.add('clicked');
            heartsBursted++;
            
            const centerX = heartObj.x + heartObj.size/2;
            const centerY = heartObj.y + heartObj.size/2;
            
            createHeartBurst(centerX, centerY, heartObj.config.color, heartObj.config.emoji);
            
            // Only show individual quotes if game is active (manual capture)
            if (gameActive) {
                showFloatingQuote(centerX, centerY, heartObj.config.color);
            }
            
            updateProgress();
        }

        function showFloatingQuote(x, y, color) {
            const quoteEl = document.createElement('div');
            quoteEl.className = 'floating-quote';
            quoteEl.innerText = loveQuotes[Math.floor(Math.random() * loveQuotes.length)];
            quoteEl.style.left = `${x}px`;
            quoteEl.style.top = `${y}px`;
            quoteEl.style.transform = 'translate(-50%, -50%)';
            quoteEl.style.color = color;
            document.body.appendChild(quoteEl);

            quoteEl.animate([
                { opacity: 0, transform: 'translate(-50%, -20%) scale(0.5)' },
                { opacity: 1, transform: 'translate(-50%, -100%) scale(1)' },
                { opacity: 1, transform: 'translate(-50%, -120%) scale(1)' },
                { opacity: 0, transform: 'translate(-50%, -150%) scale(1.1)' }
            ], {
                duration: 3500,
                easing: 'ease-out'
            }).onfinish = () => quoteEl.remove();
        }

        function spawnRandomHeart() {
            const randomConfig = heartConfigs[Math.floor(Math.random() * heartConfigs.length)];
            createHeart({
                ...randomConfig,
                size: 'small'
            });
        }

        function updateProgress() {
            const remaining = totalHeartsCreated - heartsBursted;
            if (remaining === 0 && gameActive) {
                gameActive = false;
                message.classList.add('show-message');
                instructionText.style.opacity = '0';
                timerDisplay.style.opacity = '0';
                clearInterval(countdown);
            } else if (gameActive) {
                instructionText.innerText = `Hearts remaining: ${remaining} (Don't miss!)`;
            }
        }

        heartConfigs.forEach(config => createHeart(config));

        function roam() {
            activeHearts.forEach(h => {
                if (h.isBursted) return;
                h.x += h.vx;
                h.y += h.vy;
                if (h.x <= 0 || h.x >= window.innerWidth - h.size) { h.vx *= -1; h.x = h.x <= 0 ? 0 : window.innerWidth - h.size; }
                if (h.y <= 0 || h.y >= window.innerHeight - h.size) { h.vy *= -1; h.y = h.y <= 0 ? 0 : window.innerHeight - h.size; }
                h.el.style.left = `${h.x}px`;
                h.el.style.top = `${h.y}px`;
            });
            requestAnimationFrame(roam);
        }

        function createHeartBurst(x, y, color, emoji) {
            for (let i = 0; i < 15; i++) {
                const mini = document.createElement('div');
                mini.innerHTML = emoji;
                mini.style.position = 'fixed';
                mini.style.fontSize = '24px';
                mini.style.left = `${x}px`;
                mini.style.top = `${y}px`;
                mini.style.zIndex = '1000';
                mini.style.pointerEvents = 'none';
                document.body.appendChild(mini);
                const angle = Math.random() * Math.PI * 2;
                const dist = 100 + Math.random() * 200;
                mini.animate([{ transform: 'translate(-50%, -50%) scale(0)', opacity: 1 }, { transform: `translate(calc(-50% + ${Math.cos(angle)*dist}px), calc(-50% + ${Math.sin(angle)*dist}px)) scale(1.5)`, opacity: 0 }], { duration: 1000, easing: 'ease-out', fill: 'forwards' });
                setTimeout(() => mini.remove(), 1000);
            }
        }

        function spawnSparkles() {
            setInterval(() => {
                activeHearts.forEach(h => {
                    if (h.isBursted || Math.random() > 0.2) return;
                    const s = document.createElement('div');
                    s.className = 'sparkle-particle';
                    const size = Math.random() * 3 + 2;
                    s.style.width = size + 'px'; s.style.height = size + 'px';
                    s.style.backgroundColor = h.config.color === '#111827' ? '#64748b' : h.config.color;
                    s.style.left = `${h.x + h.size/2 + (Math.random()-0.5)*h.size}px`;
                    s.style.top = `${h.y + h.size/2 + (Math.random()-0.5)*h.size}px`;
                    document.body.appendChild(s);
                    s.animate([{ opacity: 0, transform: 'scale(0)' }, { opacity: 0.8, transform: 'scale(1)' }, { opacity: 0, transform: 'scale(0)' }], { duration: 1000 });
                    setTimeout(() => s.remove(), 1000);
                });
            }, 300);
        }

        window.addEventListener('resize', () => {
            activeHearts.forEach(h => {
                if (h.x > window.innerWidth - h.size) h.x = window.innerWidth - h.size;
                if (h.y > window.innerHeight - h.size) h.y = window.innerHeight - h.size;
            });
        });

        roam();
        spawnSparkles();
    </script>
</body>
</html>
